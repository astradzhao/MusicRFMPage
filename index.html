<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Meta tags for social media banners, these should be filled in appropriatly as they are your "business card" -->
  <!-- Replace the content tag with appropriate information -->
  <meta name="description" content="music generation with recursive feature machines">
  <meta property="og:title" content="MusicRFM"/>
  <meta property="og:description" content="Audio samples for our paper, 'Steering Autoregressive Music Generation with Recursive Feature Machines'"/>
  <meta property="og:url" content="https://astradzhao.github.io/MusicRFMPage"/>
  <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X630-->
  <meta property="og:image" content="static/image/your_banner_image.png" />
  <meta property="og:image:width" content="1200"/>
  <meta property="og:image:height" content="630"/>


  <meta name="twitter:title" content="TWITTER BANNER TITLE META TAG">
  <meta name="twitter:description" content="TWITTER BANNER DESCRIPTION META TAG">
  <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X600-->
  <meta name="twitter:image" content="static/images/your_twitter_banner_image.png">
  <meta name="twitter:card" content="summary_large_image">
  <!-- Keywords for your paper to be indexed by-->
  <meta name="keywords" content="music generation, recursive feature machines, autoregressive models, music generation with control, generation, multimodal models, multimodal, machine learning, artificial intelligence, controllable music">
  <meta name="viewport" content="width=device-width, initial-scale=1">


  <title>Steering Autoregressive Music Generation with Recursive Feature Machines</title>
  <link rel="icon" type="image/x-icon" href="static/images/favicon.ico">
  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
  rel="stylesheet">

  <link rel="stylesheet" href="static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
  <script defer src="static/js/fontawesome.all.min.js"></script>
  <script src="static/js/index.js"></script>
</head>
<body>


  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title" style="font-size: 2.5rem; margin-bottom: 1.5rem; line-height: 1.3;">Steering Autoregressive Music Generation with Recursive Feature Machines</h1>
            <div class="is-size-5 publication-authors">
              <!-- Paper authors -->
                  </div>

                  <div class="is-size-5 publication-authors">
                    <span class="author-block">Daniel Zhao, Daniel Beaglehole, Taylor Berg-Kirkpatrick, Julian McAuley, Zachary Novack</span></span>
                  </div>

                  <div class="column has-text-centered">
                    <div class="publication-links">
                      <!-- <span class="link-block">
                        <a href="https://arxiv.org/pdf/<ARXIV PAPER ID>.pdf" target="_blank"
                        class="external-link button is-normal is-rounded is-dark">
                        <span class="icon">
                          <i class="fas fa-file-pdf"></i>
                        </span>
                        <span>Paper</span>
                      </a>
                    </span> -->

                    <span class="link-block">
                      <a href="static/pdfs/MusicRFM.pdf" target="_blank"
                      class="external-link button is-normal is-rounded is-dark">
                      <span class="icon">
                        <i class="fas fa-file-pdf"></i>
                      </span>
                      <span>Paper PDF</span>
                    </a>
                  </span>

                  <!-- <span class="link-block">
                    <a href="https://github.com/YOUR REPO HERE" target="_blank"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <span>Code</span>
                  </a>
                </span> -->

                <!-- <span class="link-block">
                  <a href="https://arxiv.org/abs/<ARXIV PAPER ID>" target="_blank"
                  class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                    <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span> -->
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Audio Samples Section -->
<section class="hero is-small">
  <div class="hero-body">
    <div class="container">
      <h2 class="title is-3 has-text-centered" style="margin-bottom: 1rem;">Audio Samples</h2>
      <p class="subtitle is-6 has-text-centered" style="margin-bottom: 3rem; margin-top: 0; font-style: italic;">Organized by control class</p>
      
      <!-- Note Controls -->
      <div style="margin-bottom: 1.5rem;">
        <h3 class="title is-4 has-text-centered" style="margin-bottom: 1.5rem;">Note Controls</h3>
        <div id="audio-carousel-notes" class="audio-carousel">
          <div class="audio-carousel-container">
            <div class="audio-carousel-item">
              <div style="display: flex; justify-content: center;">
                <audio controls preload="none" style="width: 80%; margin-bottom: 1rem;">
                  <source src="static/audio/notes/note_C_defaultprompt0_control0.6_inject0.3.flac" type="audio/flac">
                  Your browser does not support the audio element.
                </audio>
              </div>
              <h2 class="subtitle has-text-centered">
                Control: 0.6 | Modification: Note C<br>
                Trance EDM song with synths and reverb
              </h2>
            </div>
            <div class="audio-carousel-item">
              <div style="display: flex; justify-content: center;">
                <audio controls preload="none" style="width: 80%; margin-bottom: 1rem;">
                  <source src="static/audio/notes/optimal_noteG_prompt5_control0.5.flac" type="audio/flac">
                  Your browser does not support the audio element.
                </audio>
              </div>
              <h2 class="subtitle has-text-centered">
                Control: 0.5 | Modification: Note G<br>
                Dreamy future bass with chopped synth chords.
              </h2>
            </div>
            <div class="audio-carousel-item">
              <div style="display: flex; justify-content: center;">
                <audio controls preload="none" style="width: 80%; margin-bottom: 1rem;">
                  <source src="static/audio/notes/optimal_noteD_prompt13_control0.5.flac" type="audio/flac">
                  Your browser does not support the audio element.
                </audio>
              </div>
              <h2 class="subtitle has-text-centered">
                Control: 0.5 | Modification: Note D<br>
                A funky groove with slap bass, wah guitar, tight drums, and playful brass stabs, evoking a 1970s dance floor.
              </h2>
            </div>
          </div>
        </div>
      </div>

      <!-- Chord Controls -->
      <div style="margin-bottom: 1.5rem;">
        <h3 class="title is-4 has-text-centered" style="margin-bottom: 1.5rem;">Chord Controls</h3>
        <div id="audio-carousel-chords" class="audio-carousel">
          <div class="audio-carousel-container">
            <div class="audio-carousel-item">
              <div style="display: flex; justify-content: center;">
                <audio controls preload="none" style="width: 80%; margin-bottom: 1rem;">
                  <source src="static/audio/chords/augmented_chord_defaultprompt0_control0.6_inject0.3.flac" type="audio/flac">
                  Your browser does not support the audio element.
                </audio>
              </div>
              <h2 class="subtitle has-text-centered">
                Control: 0.6 | Modification: Augmented Chord<br>
                Trance EDM song with synths and reverb
              </h2>
            </div>
            <div class="audio-carousel-item">
              <div style="display: flex; justify-content: center;">
                <audio controls preload="none" style="width: 80%; margin-bottom: 1rem;">
                  <source src="static/audio/chords/minor_chord_defaultprompt0_control0.4.flac" type="audio/flac">
                  Your browser does not support the audio element.
                </audio>
              </div>
              <h2 class="subtitle has-text-centered">
                Control: 0.4 | Modification: Minor Chord<br>
                Trance EDM song with synths and reverb
              </h2>
            </div>
            <div class="audio-carousel-item">
              <div style="display: flex; justify-content: center;">
                <audio controls preload="none" style="width: 80%; margin-bottom: 1rem;">
                  <source src="static/audio/chords/optimal_chordaug_prompt5_control0.5.flac" type="audio/flac">
                  Your browser does not support the audio element.
                </audio>
              </div>
              <h2 class="subtitle has-text-centered">
                Control: 0.5 | Modification: Augmented Chord<br>
                Dreamy future bass with chopped synth chords.
              </h2>
            </div>
            <div class="audio-carousel-item">
              <div style="display: flex; justify-content: center;">
                <audio controls preload="none" style="width: 80%; margin-bottom: 1rem;">
                  <source src="static/audio/chords/optimal_chordmajor_prompt13_control0.5.flac" type="audio/flac">
                  Your browser does not support the audio element.
                </audio>
              </div>
              <h2 class="subtitle has-text-centered">
                Control: 0.5 | Modification: Major Chord<br>
                A funky groove with slap bass, wah guitar, tight drums, and playful brass stabs, evoking a 1970s dance floor.
              </h2>
            </div>
          </div>
        </div>
      </div>

      <!-- Interval Controls -->
      <div style="margin-bottom: 1.5rem;">
        <h3 class="title is-4 has-text-centered" style="margin-bottom: 1.5rem;">Interval Controls</h3>
        <div id="audio-carousel-intervals" class="audio-carousel">
          <div class="audio-carousel-container">
            <div class="audio-carousel-item">
              <div style="display: flex; justify-content: center;">
                <audio controls preload="none" style="width: 80%; margin-bottom: 1rem;">
                  <source src="static/audio/intervals/optimal_interval2_prompt5_control0.7.flac" type="audio/flac">
                  Your browser does not support the audio element.
                </audio>
              </div>
              <h2 class="subtitle has-text-centered">
                Control: 0.7 | Modification: Interval 2<br>
                Dreamy future bass with chopped synth chords.
              </h2>
            </div>
            <div class="audio-carousel-item">
              <div style="display: flex; justify-content: center;">
                <audio controls preload="none" style="width: 80%; margin-bottom: 1rem;">
                  <source src="static/audio/intervals/optimal_interval6_prompt10_control0.7.flac" type="audio/flac">
                  Your browser does not support the audio element.
                </audio>
              </div>
              <h2 class="subtitle has-text-centered">
                Control: 0.7 | Modification: Interval 6 (tritone)<br>
                A cinematic orchestral piece with soaring strings, brass, and percussion, building tension and drama.
              </h2>
            </div>
            <div class="audio-carousel-item">
              <div style="display: flex; justify-content: center;">
                <audio controls preload="none" style="width: 80%; margin-bottom: 1rem;">
                  <source src="static/audio/intervals/optimal_interval1_prompt13_control0.7.flac" type="audio/flac">
                  Your browser does not support the audio element.
                </audio>
              </div>
              <h2 class="subtitle has-text-centered">
                Control: 0.7 | Modification: Interval 1<br>
                A funky groove with slap bass, wah guitar, tight drums, and playful brass stabs, evoking a 1970s dance floor.
              </h2>
            </div>
          </div>
        </div>
      </div>

      <!-- Tempo Controls -->
      <div style="margin-bottom: 1.5rem;">
        <h3 class="title is-4 has-text-centered" style="margin-bottom: 1.5rem;">Tempo Controls</h3>
        <div id="audio-carousel-tempo" class="audio-carousel">
          <div class="audio-carousel-container">
            <div class="audio-carousel-item">
              <div style="display: flex; justify-content: center;">
                <audio controls preload="none" style="width: 80%; margin-bottom: 1rem;">
                  <source src="static/audio/tempo/optimal_exptime_tempos_prompt10_control-0.2.flac" type="audio/flac">
                  Your browser does not support the audio element.
                </audio>
              </div>
              <h2 class="subtitle has-text-centered">
                Control: -0.2 | Modification: Slow Tempo<br>
                A cinematic orchestral piece with soaring strings, brass, and percussion, building tension and drama.
              </h2>
            </div>
            <div class="audio-carousel-item">
              <div style="display: flex; justify-content: center;">
                <audio controls preload="none" style="width: 80%; margin-bottom: 1rem;">
                  <source src="static/audio/tempo/optimal_exptime_tempos_prompt10_control0.2.flac" type="audio/flac">
                  Your browser does not support the audio element.
                </audio>
              </div>
              <h2 class="subtitle has-text-centered">
                Control: 0.2 | Modification: Fast Tempo<br>
                A cinematic orchestral piece with soaring strings, brass, and percussion, building tension and drama.
              </h2>
            </div>
          </div>
        </div>
      </div>

      <!-- Multi-Direction Controls -->
      <div style="margin-bottom: 1.5rem;">
        <h3 class="title is-4 has-text-centered" style="margin-bottom: 1.5rem;">Multi-Direction Controls</h3>
        <div id="audio-carousel-multi" class="audio-carousel">
          <div class="audio-carousel-container">
            <div class="audio-carousel-item">
              <div style="display: flex; justify-content: center;">
                <audio controls preload="none" style="width: 80%; margin-bottom: 1rem;">
                  <source src="static/audio/other_stuff/noteFsharp_tempo_prompt10_control_0.5_0.3.flac" type="audio/flac">
                  Your browser does not support the audio element.
                </audio>
              </div>
              <h2 class="subtitle has-text-centered">
                Double Control: 0.5, 0.3 | Modification: Note F# and Fast Tempo<br>
                A cinematic orchestral piece with soaring strings, brass, and percussion, building tension and drama.
              </h2>
            </div>
            <div class="audio-carousel-item">
              <div style="display: flex; justify-content: center;">
                <audio controls preload="none" style="width: 80%; margin-bottom: 1rem;">
                  <source src="static/audio/other_stuff/noteFsharp_tempo_prompt10_control_0.5_-0.3.flac" type="audio/flac">
                  Your browser does not support the audio element.
                </audio>
              </div>
              <h2 class="subtitle has-text-centered">
                Double Control: 0.5, -0.3 | Modification: Note F# and Slow Tempo<br>
                A cinematic orchestral piece with soaring strings, brass, and percussion, building tension and drama.
              </h2>
            </div>
            <div class="audio-carousel-item">
              <div style="display: flex; justify-content: center;">
                <audio controls preload="none" style="width: 80%; margin-bottom: 1rem;">
                  <source src="static/audio/other_stuff/chordminor_tempo_prompt7_control_0.5_0.3.flac" type="audio/flac">
                  Your browser does not support the audio element.
                </audio>
              </div>
              <h2 class="subtitle has-text-centered">
                Double Control: 0.5, 0.3 | Modification: Minor Chord and Fast Tempo<br>
                A slow, melancholic classical piano solo with expressive dynamics and a gentle, flowing melody.
              </h2>
            </div>
            <div class="audio-carousel-item">
              <div style="display: flex; justify-content: center;">
                <audio controls preload="none" style="width: 80%; margin-bottom: 1rem;">
                  <source src="static/audio/other_stuff/chordminor_tempo_prompt7_control_0.5_-0.3.flac" type="audio/flac">
                  Your browser does not support the audio element.
                </audio>
              </div>
              <h2 class="subtitle has-text-centered">
                Double Control: 0.5, -0.3 | Modification: Minor Chord and Slow Tempo<br>
                A slow, melancholic classical piano solo with expressive dynamics and a gentle, flowing melody.
              </h2>
            </div>
            <div class="audio-carousel-item">
              <div style="display: flex; justify-content: center;">
                <audio controls preload="none" style="width: 80%; margin-bottom: 1rem;">
                  <source src="static/audio/other_stuff/noteD_chordminor_prompt2_control_0.5_0.5.flac" type="audio/flac">
                  Your browser does not support the audio element.
                </audio>
              </div>
              <h2 class="subtitle has-text-centered">
                Double Control: 0.5, 0.5 | Modification: Note D and Minor Chord<br>
                Fast beat, hip hop, upbeat that has a positive vibe
              </h2>
            </div>
          </div>
        </div>
      </div>

      <!-- Temporal Controls -->
      <div style="margin-bottom: 1.5rem;">
        <h3 class="title is-4 has-text-centered" style="margin-bottom: 1.5rem;">Temporal Controls</h3>
        <div id="audio-carousel-temporal" class="audio-carousel">
          <div class="audio-carousel-container">
            <div class="audio-carousel-item">
              <div style="display: flex; justify-content: center;">
                <audio controls preload="none" style="width: 80%; margin-bottom: 1rem;">
                  <source src="static/audio/other_stuff/interval2to7_prompt16_control_0.5_0.5.flac" type="audio/flac">
                  Your browser does not support the audio element.
                </audio>
              </div>
              <h2 class="subtitle has-text-centered">
                Double Control: 0.5, 0.5 | Modification: Interval 2 -> 7 over time<br>
                A high-energy electronic dance track with pulsating synths, sidechained kick, and a euphoric drop.
              </h2>
            </div>
            <div class="audio-carousel-item">
              <div style="display: flex; justify-content: center;">
                <audio controls preload="none" style="width: 80%; margin-bottom: 1rem;">
                  <source src="static/audio/other_stuff/noteAtoE_prompt6_control_0.5_0.5.flac" type="audio/flac">
                  Your browser does not support the audio element.
                </audio>
              </div>
              <h2 class="subtitle has-text-centered">
                Double Control: 0.5, 0.5 | Modification: Note A -> E over time<br>
                A fast-paced rock song featuring electric guitars, energetic drums, and a driving bassline, evoking excitement.
              </h2>
            </div>
          </div>
        </div>
      </div>

      <!-- Baseline / No Control Section -->
      <div style="margin-bottom: 1.5rem;">
        <h3 class="title is-4 has-text-centered" style="margin-bottom: 1.5rem;">Baseline (No Control)</h3>
        <div id="audio-carousel-baseline" class="audio-carousel">
          <div class="audio-carousel-container">
            <div class="audio-carousel-item">
              <div style="display: flex; justify-content: center;">
                <audio controls preload="none" style="width: 80%; margin-bottom: 1rem;">
                  <source src="static/audio/basegens/base_0.flac" type="audio/flac">
                  Your browser does not support the audio element.
                </audio>
              </div>
              <h2 class="subtitle has-text-centered">
                Trance EDM song with synths and reverb
              </h2>
            </div>
            <div class="audio-carousel-item">
              <div style="display: flex; justify-content: center;">
                <audio controls preload="none" style="width: 80%; margin-bottom: 1rem;">
                  <source src="static/audio/basegens/base_2.flac" type="audio/flac">
                  Your browser does not support the audio element.
                </audio>
              </div>
              <h2 class="subtitle has-text-centered">
                Fast beat, hip hop, upbeat that has a positive vibe
              </h2>
            </div>
            <div class="audio-carousel-item">
              <div style="display: flex; justify-content: center;">
                <audio controls preload="none" style="width: 80%; margin-bottom: 1rem;">
                  <source src="static/audio/basegens/base_5.flac" type="audio/flac">
                  Your browser does not support the audio element.
                </audio>
              </div>
              <h2 class="subtitle has-text-centered">
                Dreamy future bass with chopped synth chords.
              </h2>
            </div>
            <div class="audio-carousel-item">
              <div style="display: flex; justify-content: center;">
                <audio controls preload="none" style="width: 80%; margin-bottom: 1rem;">
                  <source src="static/audio/basegens/base_6.flac" type="audio/flac">
                  Your browser does not support the audio element.
                </audio>
              </div>
              <h2 class="subtitle has-text-centered">
                A fast-paced rock song featuring electric guitars, energetic drums, and a driving bassline, evoking excitement.
              </h2>
            </div>
            <div class="audio-carousel-item">
              <div style="display: flex; justify-content: center;">
                <audio controls preload="none" style="width: 80%; margin-bottom: 1rem;">
                  <source src="static/audio/basegens/base_7.flac" type="audio/flac">
                  Your browser does not support the audio element.
                </audio>
              </div>
              <h2 class="subtitle has-text-centered">
                A slow, melancholic classical piano solo with expressive dynamics and a gentle, flowing melody.
              </h2>
            </div>
            <div class="audio-carousel-item">
              <div style="display: flex; justify-content: center;">
                <audio controls preload="none" style="width: 80%; margin-bottom: 1rem;">
                  <source src="static/audio/basegens/base_10.flac" type="audio/flac">
                  Your browser does not support the audio element.
                </audio>
              </div>
              <h2 class="subtitle has-text-centered">
                A cinematic orchestral piece with soaring strings, brass, and percussion, building tension and drama.
              </h2>
            </div>
            <div class="audio-carousel-item">
              <div style="display: flex; justify-content: center;">
                <audio controls preload="none" style="width: 80%; margin-bottom: 1rem;">
                  <source src="static/audio/basegens/base_13.flac" type="audio/flac">
                  Your browser does not support the audio element.
                </audio>
              </div>
              <h2 class="subtitle has-text-centered">
                A funky groove with slap bass, wah guitar, tight drums, and playful brass stabs, evoking a 1970s dance floor.
              </h2>
            </div>
            <div class="audio-carousel-item">
              <div style="display: flex; justify-content: center;">
                <audio controls preload="none" style="width: 80%; margin-bottom: 1rem;">
                  <source src="static/audio/basegens/base_16.flac" type="audio/flac">
                  Your browser does not support the audio element.
                </audio>
              </div>
              <h2 class="subtitle has-text-centered">
                A high-energy electronic dance track with pulsating synths, sidechained kick, and a euphoric drop.
              </h2>
            </div>
          </div>
        </div>
      </div>
      <!-- End audio carousel -->
    </div>
  </div>
</section>
<!-- End audio carousel -->

<!-- Paper abstract -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
          Controllable music generation remains a significant challenge, with existing methods often requiring model retraining or introducing audible artifacts. We introduce <strong>MusicRFM</strong>, a framework that adapts Recursive Feature Machines (RFMs) to enable fine-grained, interpretable control over frozen, pre-trained music models by directly steering their internal activations. 
          </p>
          <p>
          RFMs analyze a model's internal gradients to produce interpretable "concept directions", or specific axes in the activation space that correspond to musical attributes like notes or chords. We first train lightweight RFM probes to discover these directions within MusicGen's hidden states; then, during inference, we inject them back into the model to guide the generation process in real-time without per-step optimization. 
          </p>
          <p>
          We present advanced mechanisms for this control, including dynamic, time-varying schedules and methods for the simultaneous enforcement of multiple musical properties. Our method successfully navigates the trade-off between control and generation quality: we can <strong>increase the accuracy of generating a target musical note from 0.23 to 0.82</strong>, while text prompt adherence remains within approximately 0.02 of the unsteered baseline, demonstrating effective control with minimal impact on prompt fidelity.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End paper abstract -->




<!-- Paper poster -->
<!-- <section class="hero is-small is-light">
  <div class="hero-body">
    <div class="container">
      <h2 class="title">Poster</h2>

      <iframe  src="static/pdfs/sample.pdf" width="100%" height="550">
          </iframe>
        
      </div>
    </div>
  </section> -->
<!--End paper poster -->



  <footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">

          <p>
            This page was built using the <a href="https://github.com/eliahuhorwitz/Academic-project-page-template" target="_blank">Academic Project Page Template</a> which was adopted from the <a href="https://nerfies.github.io" target="_blank">Nerfies</a> project page.
            <br> This website is licensed under a <a rel="license"  href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>

        </div>
      </div>
    </div>
  </div>
</footer>

<!-- Statcounter tracking code -->
  
<!-- You can add a tracker to track page visits by creating an account at statcounter.com -->

    <!-- End of Statcounter Code -->

  </body>
  </html>
